$(document).ready(function(){if(typeof console==="undefined"){console={log:function(){}}}FB.api("/"+fbr_user_id+"/posts","get",{access_token:fbr_access_token},parseAndDisplayFeed)});function parseAndDisplayFeed(b){if(!b||!b.data){console.log("Error loading feed");console.log(b);return}if($("div#fb-reflector div#paging-link").length>0){$("div#fb-reflector div#paging-link").remove()}for(var c=0,a=b.data.length;c<a;c++){$(buildItem(b.data[c])).hide().appendTo("div#fb-reflector").fadeIn()}if(b.paging&&b.paging.next){$("<div id='paging-link'><a href='javascript:void(0);'>Older Posts</a></div>").hide().appendTo("div#fb-reflector").fadeIn();var d=b.paging.next.replace(/https:\/\/graph.facebook.com/i,"");$("div#fb-reflector div#paging-link a").click(function(){FB.api(d,"get",{access_token:fbr_access_token},parseAndDisplayFeed)})}}function buildItem(g){if(!g.message){return""}console.log(g);var a=g.attribution?g.attribution:"Facebook";var f=$("<div class='feed-item'></div>");f.append("<div class='message'>"+g.message.replace(/\n/g,"<br />")+"</div>");var e=$("<div class='metadata'></div>");e.append(convertDateTimeString(g.created_time)+" via "+a+" - <a href='#'>Commment</a> - <a href='#'>Like</a>");if(g.comments){var c=$("<div class='comments'></div>");f.append(c);for(var d=0,b=g.comments.data.length;d<b;d++){$(buildComment(g.comments.data[d])).hide().appendTo(c).fadeIn()}}return f}function buildComment(d){if(!d.message){return""}var c=$("<div class='comment'></div>");c.append("<div class='comment-photo'><img src='http://graph.facebook.com/"+d.from.id+"/picture?type=square' alt='"+d.from.name+"' width='50' height='50' /></div>");var b=$("<div class='comment-details'></div");c.append(b);b.append("<div class='commenter'>"+d.from.name+"</div>");b.append("<div class='comment-text'>"+d.message.replace(/\n/g,"<br />")+"</div>");var a=$("<div class='metadata'></div>");b.append(a);a.append(convertDateTimeString(d.created_time)+" via Facebook");return c}function convertDateTimeString(b){parts=/(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})([+-]\d{4})/(b);utc_time=Date.UTC(parts[1],parseInt(parts[2],10)-1,parts[3],parts[4],parts[5],parts[6]);date=new Date(utc_time);var c=["January","February","March","April","May","June","July","August","September","October","November","December"];var e=c[date.getMonth()];var a=date.getDate();var d=(date.getHours()%12||12)+":"+(date.getMinutes()<10?"0":"")+date.getMinutes()+(date.getHours()<12?"am":"pm");return e+" "+a+" at "+d};